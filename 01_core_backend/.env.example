# StudyAI API Gateway Environment Configuration
# Copy this to .env and adjust values as needed

# =================================
# PHASE 1: API Gateway Foundation
# =================================

# Core API Gateway Settings
NODE_ENV=development
PORT=4000
LOG_LEVEL=info

# AI Engine Configuration
AI_ENGINE_URL=http://localhost:8000
AI_ENGINE_TIMEOUT=180000
AI_ENGINE_RETRIES=2
AI_ENGINE_ENABLED=true

# =================================
# FEATURE FLAGS
# =================================

# Enable/disable gateway functionality (ROLLBACK CONTROL)
USE_API_GATEWAY=true

# Health check and monitoring
ENABLE_HEALTH_CHECKS=true
ENABLE_METRICS=true
ENABLE_GATEWAY_LOGGING=true

# Performance settings
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =================================
# PHASE 2: Service Authentication & Security (NEW)
# =================================

# Service Authentication
SERVICE_AUTH_ENABLED=true
SERVICE_JWT_SECRET=your-super-secure-service-jwt-secret-here
SERVICE_NAME=api-gateway
SERVICE_TOKEN_EXPIRY=15m

# Request Validation
REQUEST_VALIDATION_ENABLED=true
VALIDATION_STRICT_MODE=false

# Security Settings
ENCRYPTION_KEY=your-32-byte-hex-encryption-key-here
SECURE_HEADERS_ENABLED=true

# User Authentication (existing)
JWT_SECRET=your-user-jwt-secret
USER_JWT_SECRET=your-user-jwt-secret

# =================================
# EXTERNAL API KEYS & SECRETS
# =================================

# OpenAI API
OPENAI_API_KEY=your-openai-api-key-here

# ElevenLabs API - Required for kid-friendly TTS voices
ELEVENLABS_API_KEY=your-elevenlabs-api-key-here

# Database Configuration
SUPABASE_URL=your-supabase-url
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_KEY=your-supabase-service-key

# Redis Configuration - Required for question caching (cost optimization)
# Saves ~$300-600/month by caching AI-generated questions for 7 days
REDIS_URL=redis://localhost:6379

# =================================
# FUTURE PHASES (Not yet implemented)
# =================================

# Phase 3: API Contracts
# OPENAPI_VALIDATION_ENABLED=false
# CONTRACT_TESTING_ENABLED=false

# Phase 4: Message Queue (Future - not yet implemented)
# QUEUE_ENABLED=false
# MAX_QUEUE_SIZE=1000

# Phase 5: iOS Integration
# IOS_CLIENT_VERSION=1.0.0
# ASYNC_JOBS_ENABLED=false

# =================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# =================================

# Development Settings
# (Values above are suitable for development)

# Production Settings (uncomment and modify for production)
# NODE_ENV=production
# LOG_LEVEL=warn
# SERVICE_AUTH_ENABLED=true
# VALIDATION_STRICT_MODE=true
# ENABLE_GATEWAY_LOGGING=false
# RATE_LIMIT_MAX_REQUESTS=1000
# =================================
# SECURITY & PRIVACY
# =================================

# Encryption Key for Data at Rest (AES-256)
# Generate a secure key using: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# CRITICAL: Keep this secret\! Store in Railway environment variables, never commit to git
ENCRYPTION_KEY=your-encryption-key-here-generate-using-command-above

# Analytics Salt for Data Anonymization (GDPR Compliance)
# Used for one-way hashing of user IDs in anonymized analytics
# Generate using: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ANALYTICS_SALT=studyai-analytics-2025-change-in-production

