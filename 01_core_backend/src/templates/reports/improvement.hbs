<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Areas of Improvement - {{studentName}}</title>
    <style>{{{inlineCSS}}}</style>
</head>
<body>
    <div class="container">
        {{> header
            reportTitle="üéØ Areas for Improvement"
            studentName=studentName
            reportPeriod=reportPeriod
        }}

        {{#if hasImprovements}}
        {{#each subjectImprovements}}
        <div class="section">
            <h2>{{this.subject}}</h2>

            <!-- Current Performance -->
            <div style="background: #f9fafb; padding: 16px; border-radius: 8px; margin: 16px 0;">
                <p><strong>Current Accuracy:</strong> {{percent this.accuracy}}</p>
                {{#if this.accuracyLastWeek}}
                <p><strong>Last Week:</strong> {{percent this.accuracyLastWeek}}</p>
                <p><strong>Change:</strong>
                    {{#if (gt this.change 0)}}
                    ‚¨ÜÔ∏è +{{percent this.change}} ({{this.trend}})
                    {{else if (lt this.change 0)}}
                    ‚¨áÔ∏è {{percent this.change}} ({{this.trend}})
                    {{else}}
                    ‚û°Ô∏è No change
                    {{/if}}
                </p>
                {{/if}}
                <p><strong>Total Errors:</strong> {{this.totalErrors}}</p>
            </div>

            <!-- Error Breakdown -->
            {{#if this.errorTypes}}
            <h3>Error Patterns</h3>
            {{#each this.errorTypes}}
            <div style="margin: 16px 0; padding: 12px; background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 4px;">
                <p><strong>{{this.typeName}}</strong> ({{this.count}} instances
                {{#if this.lastWeekCount}}
                , {{#if (gt this.change 0)}}+{{this.change}}{{else}}{{this.change}}{{/if}} from last week
                {{/if}}
                )</p>

                {{#if this.examples}}
                <p style="margin-top: 8px;"><em>Examples:</em></p>
                <ul style="margin-top: 4px;">
                    {{#each this.examples}}
                    <li>{{this}}</li>
                    {{/each}}
                </ul>
                {{/if}}

                {{#if this.suggestion}}
                <p style="margin-top: 8px;"><strong>How to help:</strong> {{this.suggestion}}</p>
                {{/if}}
            </div>
            {{/each}}
            {{/if}}

            <!-- Parent Action -->
            {{#if this.parentAction}}
            <div style="background: #dbeafe; padding: 16px; border-radius: 8px; margin-top: 16px;">
                <p><strong>üéØ Specific Action:</strong> {{this.parentAction}}</p>
            </div>
            {{/if}}
        </div>
        {{/each}}
        {{else}}
        <div class="section">
            <div class="alert alert-success">
                <h2>üéâ Great Work!</h2>
                <p>No major areas of concern detected. {{studentName}} is performing well across all subjects!</p>
            </div>
        </div>
        {{/if}}

        {{> footer generatedAtFormatted=generatedAtFormatted appVersion=appVersion}}
    </div>
</body>
</html>
